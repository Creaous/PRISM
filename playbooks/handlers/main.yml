---
# Shared handlers for PRISM playbooks
# These handlers can be reused across all playbooks

- name: Update GRUB
  ansible.builtin.command: update-grub
  changed_when: true

- name: Restart SSH service
  ansible.builtin.systemd:
    name: sshd
    state: restarted

- name: Restart auditd
  ansible.builtin.service:
    name: auditd
    state: restarted

- name: Apply sysctl settings
  ansible.builtin.command: sysctl --system
  changed_when: true

- name: Update initramfs
  ansible.builtin.command: update-initramfs -u
  changed_when: true

- name: Reload firewalld
  ansible.builtin.systemd:
    name: firewalld
    state: reloaded

- name: Restart fail2ban
  ansible.builtin.systemd:
    name: fail2ban
    state: restarted
